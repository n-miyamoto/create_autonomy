<launch>
  <arg name="robot_id"  default="$(optenv ID 1)"      doc="Unique identifier of the robot [1-Inf.)"/>
  <arg name="ns"        value="create$(arg robot_id)" doc="Namespace of the robot. By default: create1"/>
  <arg name="tf_prefix" value="$(arg ns)_tf"          doc="Tf prefix"/>

  <arg name="laser" default="$(optenv LASER rplidar)" doc="Laser for mapping the environment"/>

  <group if="$(eval arg('laser')!='rplidar')">
    <!--
      depthimage_to_laserscan uses lazy subscribing and will not subscribe to
      image or camera_info until there is a subscriber for scan.
      -->
    <node pkg="depthimage_to_laserscan" type="depthimage_to_laserscan" name="depthimage_to_laserscan"
          output="screen" ns="$(arg laser)">
    <!-- <node pkg="nodelet" type="nodelet" name="depthimage_to_laserscan"
          output="screen" ns="$(arg laser)"
          args="load depthimage_to_laserscan/DepthImageToLaserScanNodelet nodelet_manager"> -->
      <remap from="image" to="depth_registered/image_raw"/>
      <remap from="camera_info" to="depth_registered/camera_info"/>
      <remap from="scan" to="scan"/>
      <rosparam file="$(find ca_slam)/config/depthimage_to_laserscan.yaml" command="load"/>
      <param name="output_frame_id" type="string" value="$(arg tf_prefix)/$(arg laser)_link"/>
    </node>
  </group>
</launch>